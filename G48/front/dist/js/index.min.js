function UpdateData(){this.maskWrapper=jQuery(".mask-wrapper")}function QueryBtn(){this.queryBtn=jQuery("#btn-search")}UpdateData.prototype.showEvent=function(){this.maskWrapper.show()},UpdateData.prototype.hideEvent=function(){},UpdateData.prototype.onopen=function(){var e=jQuery("#project-name").val().trim(),t=jQuery("#svn-host").val().trim(),o=jQuery("#git-username").val().trim(),n=jQuery("#git-password").val().trim(),r=jQuery("#svn-save").val().trim();if(""!==e&&""!==t&&""!==o&&""!==n&&""!=r){var s={type:"svnUpdate",name:e,host:t,username:o,password:n,localRoad:r},a=JSON.stringify(s);window.socket.send(a),jQuery("#myModal").modal("hide"),jQuery("#modal_info").show()}else alert("必填项不能为空！")},UpdateData.prototype.onmessage=function(e){if("string"==typeof e.data)if(isNaN(Number(e.data))){var t=JSON.parse(e.data);if("type"in t){var o=t.type;if("path_error"===o)return void alert("保存路径不存在！");if("not_found"===o&&(console.log("not_found"),jQuery("#not-found").show()),"update_files"===o){jQuery("#update-progress-group").show();var n=jQuery("#update-progressbar");n.width(t.finish_precent),n.text("已更新:"+t.finish_precent);var r=jQuery("#show_error_info"),s=jQuery("#show_error_files");t.filename&&(r.show(),s.append("<li>"+t.filename+"</li>"))}}var a=t.datas,i=template("query-item",{datas:a});jQuery("#show_excel").append(i)}else progress.text(e.data+"% Complete (success)"),progress.css({width:e.data+"%"});else alert("非文本消息")},UpdateData.prototype.listenShowHideEvent=function(){var o=this;jQuery("#submit-local").click(function(e){e.preventDefault(),jQuery("#show_error_files").children("li").remove(),jQuery("#progress-group").hide(),jQuery("#not-found").hide();var t=jQuery("#project-name").val().trim();if(jQuery(".project-name").text(t),null==window.socket){window.socket=new WebSocket("ws://10.240.113.164:9005/"),window.socket.onopen=function(e){o.onopen()}}else o.onopen();window.socket.onmessage=function(e){o.onmessage(e)}})},UpdateData.prototype.run=function(){this.listenShowHideEvent()},$(function(){(new UpdateData).run()}),QueryBtn.prototype.listenClickEnterEvent=function(){var t=this;t.queryBtn.click(function(){t.connectionEvent()}),t.queryBtn.keypress(function(e){13==e.keyCode&&t.connectionEvent()})},QueryBtn.prototype.connectionEvent=function(){var n=this;if(jQuery("#update-progress-group").hide(),jQuery("#show_error_info").hide(),jQuery("#modal_info").hide(),null==window.socket){n.socket=new WebSocket("ws://10.240.113.164:9005/"),window.socket=n.socket,jQuery("#progress-group").show(),(s=jQuery("#progressbar")).css({width:0}),s.text("0.0% Complete (success)"),jQuery("#show_excel").html("");try{n.socket.onopen=function(e){var t=new Object;if(t.type="queryInfo",t.keyword=jQuery("#inputKeyword").val(),0!==t.keyword.length){console.log("not empyt"),t.queryMode=jQuery("#select-type").val(),t.tableType=jQuery("#table-type1").val(),t.selectScope=jQuery("#select-scope").val();var o=JSON.stringify(t);n.socket.send(o)}else console.log("empty")},n.socket.onmessage=function(e){if("string"==typeof e.data)if(isNaN(Number(e.data))){var t=JSON.parse(e.data);if("type"in t){var o=t.type;"not_found"===o&&(console.log("not_found"),jQuery("#not-found").show()),"badFiles"===o&&console.log("badFiles Test"),"more_data"===o&&console.log("more_data")}var n=t.datas,r=template("query-item",{datas:n});jQuery("#show_excel").append(r)}else s.text(e.data+"% Complete (success)"),s.css({width:e.data+"%"});else alert("非文本消息")},n.socket.onclose=function(e){alert("socket closed!")}}catch(e){log(e)}}else{var s;jQuery("#not-found").hide(),n.socket=window.socket,jQuery("#progress-group").show(),(s=jQuery("#progressbar")).css({width:0}),s.text("0.0% Complete (success)"),jQuery("#show_excel").html("");try{var e=new Object;if(e.type="queryInfo",e.keyword=jQuery("#inputKeyword").val(),0!==e.keyword.length){e.queryMode=jQuery("#select-type").val(),e.tableType=jQuery("#table-type1").val(),e.selectScope=jQuery("#select-scope").val();var t=JSON.stringify(e);n.socket.send(t)}else console.log("empty");n.socket.onmessage=function(e){if("string"==typeof e.data)if(isNaN(Number(e.data))){var t=JSON.parse(e.data);if("type"in t){var o=t.type;"not_found"===o&&(console.log("not_found"),jQuery("#not-found").show()),"badFiles"===o&&console.log("badFiles Test")}var n=t.datas,r=template("query-item",{datas:n});jQuery("#show_excel").append(r)}else s.text(e.data+"% Complete (success)"),s.css({width:e.data+"%"}),console.log(s.width);else alert("非文本消息")},n.socket.onclose=function(e){alert("socket closed!")}}catch(e){log(e)}}},QueryBtn.prototype.run=function(){this.listenClickEnterEvent()},$(function(){var t=new QueryBtn;t.run(),jQuery("#inputKeyword").keypress(function(e){13==e.keyCode&&t.connectionEvent()}),jQuery("#reset-search").click(function(){jQuery(".form-horizontal")[0].reset()}),jQuery("#update").click(function(){if(null==window.socket)alert("请先配置！！！");else{var e=new Object;e.type="update_request";var t=JSON.stringify(e);window.socket.send(t)}}),window.socket=null});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIlVwZGF0ZURhdGEiLCJ0aGlzIiwibWFza1dyYXBwZXIiLCJqUXVlcnkiLCJRdWVyeUJ0biIsInF1ZXJ5QnRuIiwicHJvdG90eXBlIiwic2hvd0V2ZW50Iiwic2hvdyIsImhpZGVFdmVudCIsIm9ub3BlbiIsInByak5hbWUiLCJ2YWwiLCJ0cmltIiwic3ZuSG9zdCIsInVzZXIiLCJwYXNzd29yZCIsImxvY2FsU2F2ZVJvYWQiLCJkYXRhIiwidHlwZSIsIm5hbWUiLCJob3N0IiwidXNlcm5hbWUiLCJsb2NhbFJvYWQiLCJqc29uUXVlcnlJbmZvIiwiSlNPTiIsInN0cmluZ2lmeSIsIndpbmRvdyIsInNvY2tldCIsInNlbmQiLCJtb2RhbCIsImFsZXJ0Iiwib25tZXNzYWdlIiwibXNnIiwiaXNOYU4iLCJOdW1iZXIiLCJqc29uX29iaiIsInBhcnNlIiwiY29uc29sZSIsImxvZyIsInVwZGF0ZV9wcm9ncmVzc2JhciIsIndpZHRoIiwidGV4dCIsInNob3dfZXJyb3JfaW5mbyIsInNob3dfZXJyb3JfZmlsZSIsImFwcGVuZCIsImRhdGFzIiwiaHRtbCIsInRlbXBsYXRlIiwicHJvZ3Jlc3MiLCJjc3MiLCJsaXN0ZW5TaG93SGlkZUV2ZW50Iiwic2VsZiIsImNsaWNrIiwiZSIsInByZXZlbnREZWZhdWx0IiwiY2hpbGRyZW4iLCJyZW1vdmUiLCJoaWRlIiwiV2ViU29ja2V0IiwicnVuIiwiJCIsImxpc3RlbkNsaWNrRW50ZXJFdmVudCIsImNvbm5lY3Rpb25FdmVudCIsImtleXByZXNzIiwia2V5Q29kZSIsInF1ZXJ5SW5mbyIsIk9iamVjdCIsImtleXdvcmQiLCJsZW5ndGgiLCJxdWVyeU1vZGUiLCJ0YWJsZVR5cGUiLCJzZWxlY3RTY29wZSIsIm9uY2xvc2UiLCJleCIsInF1ZXJ5QnRuT2oiLCJyZXNldCIsInVwZGF0ZV9pbmZvIiwianNvbl91cGRhdGVfaW5mbyJdLCJtYXBwaW5ncyI6IkFBQ0EsU0FBU0EsYUFDTUMsS0FD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SUFBSWtCLEVBQVdYLEtBQUtZLE1BQU1KLEVBQUlmLE1BQzlCLEdBQUksU0FBVWtCLEVBQ2QsQ0FDSSxJQUFJakIsRUFBT2lCLEVBQWUsS0FDYixjQUFUakIsSUFFQW1CLFFBQVFDLElBQUksYUFDWnBDLE9BQU8sY0FBY0ssUUFFWixhQUFUVyxHQUVBbUIsUUFBUUMsSUFBSSxpQkFJcEIsSUFBSU8sRUFBUVYsRUFBZ0IsTUFDeEJXLEVBQU9DLFNBQVMsYUFBYSxDQUFDRixNQUFTQSxJQUMxQjNDLE9BQU8sZUFDYjBDLE9BQU9FLFFBR2xCRSxFQUFTUCxLQUFLVCxFQUFJZixLQUFRLHdCQUMxQitCLEVBQVNDLElBQUksQ0FBQ1QsTUFBU1IsRUFBSWYsS0FBTyxNQUNsQ29CLFFBQVFDLElBQUlVLEVBQVNSLFlBSXpCVixNQUFNLFVBR2RxQixFQUFLeEIsT0FBTzZDLFFBQVUsU0FBVXhDLEdBQU9GLE1BQU0sbUJBRWpELE1BQU8yQyxHQUNIbkMsSUFBSW1DLE1BS2hCdEUsU0FBU0UsVUFBVXNELElBQU0sV0FDVjNELEtBQ042RCx5QkFHVEQsRUFBRSxXQUNFLElBQUljLEVBQWEsSUFBSXZFLFNBQ3JCdUUsRUFBV2YsTUFDUXpELE9BQU8saUJBQ2I2RCxTQUFTLFNBQVVWLEdBQ1gsSUFBYkEsRUFBRVcsU0FDRlUsRUFBV1osb0JBRW5CNUQsT0FBTyxpQkFBaUJrRCxNQUFNLFdBQzFCbEQsT0FBTyxvQkFBb0IsR0FBR3lFLFVBR2xDekUsT0FBTyxXQUFXa0QsTUFBTSxXQUNwQixHQUFxQixNQUFqQjFCLE9BQU9DLE9BRVBHLE1BQU0sZUFHVixDQUNJLElBQUk4QyxFQUFjLElBQUlWLE9BQ3RCVSxFQUFZMUQsS0FBTyxpQkFDbkIsSUFBSTJELEVBQW9CckQsS0FBS0MsVUFBVW1ELEdBQ3ZDbEQsT0FBT0MsT0FBT0MsS0FBS2lELE1BSzNCbkQsT0FBT0MsT0FBUyIsImZpbGUiOiJpbmRleC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuZnVuY3Rpb24gVXBkYXRlRGF0YSgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubWFza1dyYXBwZXIgPSBqUXVlcnkoJy5tYXNrLXdyYXBwZXInKTtcclxufVxyXG5cclxuVXBkYXRlRGF0YS5wcm90b3R5cGUuc2hvd0V2ZW50ID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLm1hc2tXcmFwcGVyLnNob3coKTtcclxufTtcclxuXHJcblVwZGF0ZURhdGEucHJvdG90eXBlLmhpZGVFdmVudCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG59O1xyXG5cclxuVXBkYXRlRGF0YS5wcm90b3R5cGUub25vcGVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHByak5hbWUgPSBqUXVlcnkoXCIjcHJvamVjdC1uYW1lXCIpLnZhbCgpLnRyaW0oKTtcclxuICAgIHZhciBzdm5Ib3N0ID0galF1ZXJ5KFwiI3N2bi1ob3N0XCIpLnZhbCgpLnRyaW0oKTtcclxuICAgIHZhciB1c2VyICAgID0galF1ZXJ5KFwiI2dpdC11c2VybmFtZVwiKS52YWwoKS50cmltKCk7XHJcbiAgICB2YXIgcGFzc3dvcmQgPSBqUXVlcnkoXCIjZ2l0LXBhc3N3b3JkXCIpLnZhbCgpLnRyaW0oKTtcclxuICAgIHZhciBsb2NhbFNhdmVSb2FkID0galF1ZXJ5KFwiI3N2bi1zYXZlXCIpLnZhbCgpLnRyaW0oKTtcclxuXHJcbiAgICBpZiAoKHByak5hbWUgPT09IFwiXCIpIHx8IChzdm5Ib3N0ID09PSBcIlwiKSB8fCAodXNlciA9PT0gXCJcIikgfHwgKHBhc3N3b3JkID09PSBcIlwiKSB8fCAobG9jYWxTYXZlUm9hZCA9PSBcIlwiKSkge1xyXG4gICAgICAgIGFsZXJ0KCflv4XloavpobnkuI3og73kuLrnqbrvvIEnKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgdHlwZTogXCJzdm5VcGRhdGVcIixcclxuICAgICAgICBuYW1lOiBwcmpOYW1lLFxyXG4gICAgICAgIGhvc3Q6IHN2bkhvc3QsXHJcbiAgICAgICAgdXNlcm5hbWU6IHVzZXIsXHJcbiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkLFxyXG4gICAgICAgIGxvY2FsUm9hZDogbG9jYWxTYXZlUm9hZFxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIganNvblF1ZXJ5SW5mbyA9ICBKU09OLnN0cmluZ2lmeShkYXRhKTtcclxuICAgIHdpbmRvdy5zb2NrZXQuc2VuZChqc29uUXVlcnlJbmZvKTtcclxuICAgIGpRdWVyeShcIiNteU1vZGFsXCIpLm1vZGFsKCdoaWRlJyk7XHJcbiAgICBqUXVlcnkoXCIjbW9kYWxfaW5mb1wiKS5zaG93KCk7XHJcbiAgICAvLyB3aW5kb3cubG9jYXRpb24ucmVsb2FkKHRydWUpO1xyXG59O1xyXG5VcGRhdGVEYXRhLnByb3RvdHlwZS5vbm1lc3NhZ2UgPSBmdW5jdGlvbihtc2cpe1xyXG4gICAgaWYgKHR5cGVvZiBtc2cuZGF0YSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgaWYgIChpc05hTihOdW1iZXIobXNnLmRhdGEpKSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIC8vIOaYvuekuuafpeivoue7k+aenOS7o+eggVxyXG4gICAgICAgICAgICB2YXIganNvbl9vYmogPSBKU09OLnBhcnNlKG1zZy5kYXRhKTtcclxuICAgICAgICAgICAgaWYgKFwidHlwZVwiIGluIGpzb25fb2JqKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IGpzb25fb2JqW1widHlwZVwiXTtcclxuICAgICAgICAgICAgICAgIGlmKHR5cGUgPT09IFwicGF0aF9lcnJvclwiKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KCfkv53lrZjot6/lvoTkuI3lrZjlnKjvvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSBcIm5vdF9mb3VuZFwiKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibm90X2ZvdW5kXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGpRdWVyeShcIiNub3QtZm91bmRcIikuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYodHlwZSA9PT0gXCJ1cGRhdGVfZmlsZXNcIilcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlX3Byb2dyZXNzX2dyb3VwID0galF1ZXJ5KFwiI3VwZGF0ZS1wcm9ncmVzcy1ncm91cFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVfcHJvZ3Jlc3NfZ3JvdXAuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB1cGRhdGVfcHJvZ3Jlc3NiYXIgPSBqUXVlcnkoXCIjdXBkYXRlLXByb2dyZXNzYmFyXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZV9wcm9ncmVzc2Jhci53aWR0aChqc29uX29ialtcImZpbmlzaF9wcmVjZW50XCJdKTtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVfcHJvZ3Jlc3NiYXIudGV4dChcIuW3suabtOaWsDpcIiArIGpzb25fb2JqW1wiZmluaXNoX3ByZWNlbnRcIl0pO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNob3dfZXJyb3JfaW5mbyA9IGpRdWVyeShcIiNzaG93X2Vycm9yX2luZm9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNob3dfZXJyb3JfZmlsZSA9IGpRdWVyeShcIiNzaG93X2Vycm9yX2ZpbGVzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChqc29uX29ialtcImZpbGVuYW1lXCJdKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvd19lcnJvcl9pbmZvLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvd19lcnJvcl9maWxlLmFwcGVuZChcIjxsaT5cIisganNvbl9vYmpbXCJmaWxlbmFtZVwiXSArIFwiPC9saT5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOacieaVsOaNrlxyXG4gICAgICAgICAgICB2YXIgZGF0YXMgPSBqc29uX29ialtcImRhdGFzXCJdO1xyXG4gICAgICAgICAgICB2YXIgaHRtbCA9IHRlbXBsYXRlKCdxdWVyeS1pdGVtJyx7XCJkYXRhc1wiOiBkYXRhc30pO1xyXG4gICAgICAgICAgICB2YXIgc2hvd19leGNlbCA9IGpRdWVyeShcIiNzaG93X2V4Y2VsXCIpO1xyXG4gICAgICAgICAgICBzaG93X2V4Y2VsLmFwcGVuZChodG1sKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgLy8g6L+b5bqm5p2h55qE5Luj56CBXHJcbiAgICAgICAgICAgIHByb2dyZXNzLnRleHQobXNnLmRhdGEgKyAgJyUgQ29tcGxldGUgKHN1Y2Nlc3MpJyk7XHJcbiAgICAgICAgICAgIHByb2dyZXNzLmNzcyh7XCJ3aWR0aFwiOiBtc2cuZGF0YSArICclJ30pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGFsZXJ0KFwi6Z2e5paH5pys5raI5oGvXCIpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuVXBkYXRlRGF0YS5wcm90b3R5cGUubGlzdGVuU2hvd0hpZGVFdmVudCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHN1Ym1pdExvY2FsID0gIGpRdWVyeSgnI3N1Ym1pdC1sb2NhbCcpO1xyXG4gICAgc3VibWl0TG9jYWwuY2xpY2soZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdmFyIHNob3dfZXJyb3JfZmlsZSA9IGpRdWVyeShcIiNzaG93X2Vycm9yX2ZpbGVzXCIpO1xyXG4gICAgICAgIHNob3dfZXJyb3JfZmlsZS5jaGlsZHJlbignbGknKS5yZW1vdmUoKTtcclxuICAgICAgICBqUXVlcnkoXCIjcHJvZ3Jlc3MtZ3JvdXBcIikuaGlkZSgpO1xyXG4gICAgICAgIGpRdWVyeShcIiNub3QtZm91bmRcIikuaGlkZSgpO1xyXG4gICAgICAgIHZhciBwcmpOYW1lID0galF1ZXJ5KFwiI3Byb2plY3QtbmFtZVwiKS52YWwoKS50cmltKCk7XHJcbiAgICAgICAgalF1ZXJ5KFwiLnByb2plY3QtbmFtZVwiKS50ZXh0KHByak5hbWUpO1xyXG4gICAgICAgIGlmICh3aW5kb3cuc29ja2V0ID09IG51bGwpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgaG9zdCA9IFwid3M6Ly8xMC4yNDAuMTEzLjE2NDo5MDA1L1wiO1xyXG4gICAgICAgICAgICB3aW5kb3cuc29ja2V0ID0gbmV3IFdlYlNvY2tldChob3N0KTtcclxuICAgICAgICAgICAgd2luZG93LnNvY2tldC5vbm9wZW4gPSBmdW5jdGlvbiAobXNnKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLm9ub3BlbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHNlbGYub25vcGVuKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHdpbmRvdy5zb2NrZXQub25tZXNzYWdlID0gZnVuY3Rpb24gKG1zZykge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5vbm1lc3NhZ2UobXNnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG5VcGRhdGVEYXRhLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmxpc3RlblNob3dIaWRlRXZlbnQoKTtcclxufTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHVwZGF0ZSA9IG5ldyBVcGRhdGVEYXRhKCk7XHJcbiAgICB1cGRhdGUucnVuKCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gUXVlcnlCdG4oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLnF1ZXJ5QnRuID0galF1ZXJ5KFwiI2J0bi1zZWFyY2hcIik7XHJcbn1cclxuXHJcblF1ZXJ5QnRuLnByb3RvdHlwZS5saXN0ZW5DbGlja0VudGVyRXZlbnQgPSBmdW5jdGlvbiAoKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYucXVlcnlCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuY29ubmVjdGlvbkV2ZW50KCk7XHJcbiAgICB9KTtcclxuICAgIHNlbGYucXVlcnlCdG4ua2V5cHJlc3MoZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBpZiAoZS5rZXlDb2RlID09IDEzKVxyXG4gICAgICAgICAgICBzZWxmLmNvbm5lY3Rpb25FdmVudCgpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5RdWVyeUJ0bi5wcm90b3R5cGUuY29ubmVjdGlvbkV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgalF1ZXJ5KFwiI3VwZGF0ZS1wcm9ncmVzcy1ncm91cFwiKS5oaWRlKCk7XHJcbiAgICBqUXVlcnkoXCIjc2hvd19lcnJvcl9pbmZvXCIpLmhpZGUoKTtcclxuICAgIGpRdWVyeShcIiNtb2RhbF9pbmZvXCIpLmhpZGUoKTtcclxuXHJcbiAgICAvLyB2YXIgaG9zdCA9IFwid3M6Ly8xMC4yNDAuMTEzLjE2NDo5MDA1L1wiO1xyXG4gICAgLy8gdmFyIHNvY2tldCA9IG5ldyBXZWJTb2NrZXQoaG9zdCk7XHJcbiAgICAvLyBzb2NrZXQub25vcGVuXHJcblxyXG5cclxuXHJcbiAgICBpZih3aW5kb3cuc29ja2V0ID09IG51bGwpe1xyXG4gICAgICAgIHZhciBob3N0ID0gXCJ3czovLzEwLjI0MC4xMTMuMTY0OjkwMDUvXCI7XHJcbiAgICAgICAgc2VsZi5zb2NrZXQgPSBuZXcgV2ViU29ja2V0KGhvc3QpO1xyXG4gICAgICAgIHdpbmRvdy5zb2NrZXQgPSBzZWxmLnNvY2tldDtcclxuICAgICAgICBqUXVlcnkoXCIjcHJvZ3Jlc3MtZ3JvdXBcIikuc2hvdygpO1xyXG4gICAgICAgIHZhciBwcm9ncmVzcyA9IGpRdWVyeShcIiNwcm9ncmVzc2JhclwiKVxyXG4gICAgICAgIHByb2dyZXNzLmNzcyh7XCJ3aWR0aFwiOiAwfSk7XHJcbiAgICAgICAgcHJvZ3Jlc3MudGV4dCgnMC4wJSBDb21wbGV0ZSAoc3VjY2VzcyknKTtcclxuICAgICAgICB2YXIgc2hvd19leGNlbCA9IGpRdWVyeShcIiNzaG93X2V4Y2VsXCIpO1xyXG4gICAgICAgIHNob3dfZXhjZWwuaHRtbChcIlwiKTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBzZWxmLnNvY2tldC5vbm9wZW4gPSBmdW5jdGlvbiAobXNnKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnlJbmZvID0gbmV3IE9iamVjdCgpO1xyXG4gICAgICAgICAgICAgICAgcXVlcnlJbmZvLnR5cGUgPSBcInF1ZXJ5SW5mb1wiO1xyXG4gICAgICAgICAgICAgICAgcXVlcnlJbmZvLmtleXdvcmQgPSBqUXVlcnkoXCIjaW5wdXRLZXl3b3JkXCIpLnZhbCgpO1xyXG4gICAgICAgICAgICAgICAgaWYocXVlcnlJbmZvLmtleXdvcmQubGVuZ3RoICE9PSAwKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibm90IGVtcHl0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5SW5mby5xdWVyeU1vZGUgPSBqUXVlcnkoXCIjc2VsZWN0LXR5cGVcIikudmFsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlJbmZvLnRhYmxlVHlwZSA9IGpRdWVyeShcIiN0YWJsZS10eXBlMVwiKS52YWwoKTtcclxuICAgICAgICAgICAgICAgICAgICBxdWVyeUluZm8uc2VsZWN0U2NvcGUgPSBqUXVlcnkoXCIjc2VsZWN0LXNjb3BlXCIpLnZhbCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIganNvblF1ZXJ5SW5mbyA9ICBKU09OLnN0cmluZ2lmeShxdWVyeUluZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc29ja2V0LnNlbmQoanNvblF1ZXJ5SW5mbyk7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImVtcHR5XCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgc2VsZi5zb2NrZXQub25tZXNzYWdlID0gZnVuY3Rpb24gKG1zZykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtc2cuZGF0YSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZGlzcGxheUNvbnRlbnQobXNnLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICAoaXNOYU4oTnVtYmVyKG1zZy5kYXRhKSkpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmmL7npLrmn6Xor6Lnu5Pmnpzku6PnoIFcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGpzb25fb2JqID0gSlNPTi5wYXJzZShtc2cuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcInR5cGVcIiBpbiBqc29uX29iailcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBqc29uX29ialtcInR5cGVcIl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJub3RfZm91bmRcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5vdF9mb3VuZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqUXVlcnkoXCIjbm90LWZvdW5kXCIpLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSBcImJhZEZpbGVzXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJiYWRGaWxlcyBUZXN0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09ICBcIm1vcmVfZGF0YVwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibW9yZV9kYXRhXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOacieaVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YXMgPSBqc29uX29ialtcImRhdGFzXCJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IHRlbXBsYXRlKCdxdWVyeS1pdGVtJyx7XCJkYXRhc1wiOiBkYXRhc30pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2hvd19leGNlbCA9IGpRdWVyeShcIiNzaG93X2V4Y2VsXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaG93X2V4Y2VsLmFwcGVuZChodG1sKTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8geyPov5vluqbmnaHnmoTku6PnoIEjfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB2YXIgcHJvZ3Jlc3MgPSBqUXVlcnkoXCIjcHJvZ3Jlc3NiYXJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MudGV4dChtc2cuZGF0YSArICAnJSBDb21wbGV0ZSAoc3VjY2VzcyknKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MuY3NzKHtcIndpZHRoXCI6IG1zZy5kYXRhICsgJyUnfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCLpnZ7mlofmnKzmtojmga9cIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBzZWxmLnNvY2tldC5vbmNsb3NlID0gZnVuY3Rpb24gKG1zZykgeyBhbGVydChcInNvY2tldCBjbG9zZWQhXCIpIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChleCkge1xyXG4gICAgICAgICAgICBsb2coZXgpO1xyXG4gICAgICAgIH1cclxuICAgIH1lbHNle1xyXG4gICAgICAgIGpRdWVyeShcIiNub3QtZm91bmRcIikuaGlkZSgpO1xyXG4gICAgICAgIHNlbGYuc29ja2V0ID0gd2luZG93LnNvY2tldDtcclxuICAgICAgICBqUXVlcnkoXCIjcHJvZ3Jlc3MtZ3JvdXBcIikuc2hvdygpO1xyXG4gICAgICAgIHZhciBwcm9ncmVzcyA9IGpRdWVyeShcIiNwcm9ncmVzc2JhclwiKVxyXG4gICAgICAgIHByb2dyZXNzLmNzcyh7XCJ3aWR0aFwiOiAwfSk7XHJcbiAgICAgICAgcHJvZ3Jlc3MudGV4dCgnMC4wJSBDb21wbGV0ZSAoc3VjY2VzcyknKTtcclxuICAgICAgICB2YXIgc2hvd19leGNlbCA9IGpRdWVyeShcIiNzaG93X2V4Y2VsXCIpO1xyXG4gICAgICAgIHNob3dfZXhjZWwuaHRtbChcIlwiKTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBzZWxmLnNvY2tldC5vbm9wZW4gPSBmdW5jdGlvbiAobXNnKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnlJbmZvID0gbmV3IE9iamVjdCgpO1xyXG4gICAgICAgICAgICAgICAgcXVlcnlJbmZvLnR5cGUgPSBcInF1ZXJ5SW5mb1wiO1xyXG4gICAgICAgICAgICAgICAgcXVlcnlJbmZvLmtleXdvcmQgPSBqUXVlcnkoXCIjaW5wdXRLZXl3b3JkXCIpLnZhbCgpO1xyXG4gICAgICAgICAgICAgICAgaWYocXVlcnlJbmZvLmtleXdvcmQubGVuZ3RoICE9PSAwKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5SW5mby5xdWVyeU1vZGUgPSBqUXVlcnkoXCIjc2VsZWN0LXR5cGVcIikudmFsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlJbmZvLnRhYmxlVHlwZSA9IGpRdWVyeShcIiN0YWJsZS10eXBlMVwiKS52YWwoKTtcclxuICAgICAgICAgICAgICAgICAgICBxdWVyeUluZm8uc2VsZWN0U2NvcGUgPSBqUXVlcnkoXCIjc2VsZWN0LXNjb3BlXCIpLnZhbCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIganNvblF1ZXJ5SW5mbyA9ICBKU09OLnN0cmluZ2lmeShxdWVyeUluZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc29ja2V0LnNlbmQoanNvblF1ZXJ5SW5mbyk7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImVtcHR5XCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyB9O1xyXG5cclxuICAgICAgICAgICAgc2VsZi5zb2NrZXQub25tZXNzYWdlID0gZnVuY3Rpb24gKG1zZykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtc2cuZGF0YSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZGlzcGxheUNvbnRlbnQobXNnLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICAoaXNOYU4oTnVtYmVyKG1zZy5kYXRhKSkpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmmL7npLrmn6Xor6Lnu5Pmnpzku6PnoIFcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGpzb25fb2JqID0gSlNPTi5wYXJzZShtc2cuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcInR5cGVcIiBpbiBqc29uX29iailcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBqc29uX29ialtcInR5cGVcIl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJub3RfZm91bmRcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5vdF9mb3VuZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqUXVlcnkoXCIjbm90LWZvdW5kXCIpLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSBcImJhZEZpbGVzXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJiYWRGaWxlcyBUZXN0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOacieaVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YXMgPSBqc29uX29ialtcImRhdGFzXCJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IHRlbXBsYXRlKCdxdWVyeS1pdGVtJyx7XCJkYXRhc1wiOiBkYXRhc30pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2hvd19leGNlbCA9IGpRdWVyeShcIiNzaG93X2V4Y2VsXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaG93X2V4Y2VsLmFwcGVuZChodG1sKTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8geyPov5vluqbmnaHnmoTku6PnoIEjfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcy50ZXh0KG1zZy5kYXRhICsgICclIENvbXBsZXRlIChzdWNjZXNzKScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcy5jc3Moe1wid2lkdGhcIjogbXNnLmRhdGEgKyAnJSd9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocHJvZ3Jlc3Mud2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi6Z2e5paH5pys5raI5oGvXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBzZWxmLnNvY2tldC5vbmNsb3NlID0gZnVuY3Rpb24gKG1zZykgeyBhbGVydChcInNvY2tldCBjbG9zZWQhXCIpIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChleCkge1xyXG4gICAgICAgICAgICBsb2coZXgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuXHJcblF1ZXJ5QnRuLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubGlzdGVuQ2xpY2tFbnRlckV2ZW50KCk7XHJcbn07XHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBxdWVyeUJ0bk9qID0gbmV3IFF1ZXJ5QnRuKCk7XHJcbiAgICBxdWVyeUJ0bk9qLnJ1bigpO1xyXG4gICAgdmFyIGlucHV0S2V5d29yZCA9IGpRdWVyeShcIiNpbnB1dEtleXdvcmRcIik7XHJcbiAgICBpbnB1dEtleXdvcmQua2V5cHJlc3MoZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBpZiAoZS5rZXlDb2RlID09IDEzKVxyXG4gICAgICAgICAgICBxdWVyeUJ0bk9qLmNvbm5lY3Rpb25FdmVudCgpO1xyXG4gICAgfSk7XHJcbiAgICBqUXVlcnkoXCIjcmVzZXQtc2VhcmNoXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBqUXVlcnkoXCIuZm9ybS1ob3Jpem9udGFsXCIpWzBdLnJlc2V0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBqUXVlcnkoXCIjdXBkYXRlXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAod2luZG93LnNvY2tldCA9PSBudWxsIClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGFsZXJ0KFwi6K+35YWI6YWN572u77yB77yB77yBXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgdXBkYXRlX2luZm8gPSBuZXcgT2JqZWN0KCk7XHJcbiAgICAgICAgICAgIHVwZGF0ZV9pbmZvLnR5cGUgPSBcInVwZGF0ZV9yZXF1ZXN0XCI7XHJcbiAgICAgICAgICAgIHZhciBqc29uX3VwZGF0ZV9pbmZvID0gIEpTT04uc3RyaW5naWZ5KHVwZGF0ZV9pbmZvKTtcclxuICAgICAgICAgICAgd2luZG93LnNvY2tldC5zZW5kKGpzb25fdXBkYXRlX2luZm8pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuXHJcbiAgICB3aW5kb3cuc29ja2V0ID0gbnVsbDtcclxufSk7Il19
